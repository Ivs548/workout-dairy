<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>üèãÔ∏è –î–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #f0f9f0 0%, #d1f2d1 100%);
            color: #1a472a;
            padding: 10px;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            margin-bottom: 10px;
        }
        
        .header h1 {
            font-size: 1.5em;
            color: #1a472a;
            margin-bottom: 15px;
        }
        
        /* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π - –ü–ï–†–í–´–ô –ë–õ–û–ö */
        .categories-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .category-card {
            background: white;
            border-radius: 10px;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid transparent;
            position: relative;
        }
        
        .category-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        }
        
        .category-card.expanded {
            margin-bottom: 0;
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
        }
        
        .category-icon {
            font-size: 1.2em;
            color: #27ae60;
            margin-right: 10px;
            width: 30px;
            text-align: center;
        }
        
        .category-name {
            font-size: 0.9em;
            font-weight: 600;
            flex-grow: 1;
        }
        
        .category-count {
            font-size: 0.8em;
            color: #7f8c8d;
            background: #f8f9fa;
            padding: 2px 8px;
            border-radius: 10px;
        }
        
        .category-arrow {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-left: 8px;
            transition: transform 0.3s;
        }
        
        .category-card.expanded .category-arrow {
            transform: rotate(180deg);
        }
        
        /* –°–ø–∏—Å–æ–∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ */
        .category-exercises {
            background: #f8f9fa;
            border-radius: 0 0 10px 10px;
            margin-top: -2px;
            padding: 10px;
            display: none;
            flex-direction: column;
            gap: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }
        
        .category-exercises.show {
            display: flex;
        }
        
        .category-exercise-item {
            background: white;
            border-radius: 8px;
            padding: 10px 15px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 3px solid #27ae60;
        }
        
        .category-exercise-item:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }
        
        .category-exercise-name {
            font-size: 0.9em;
            font-weight: 500;
            flex-grow: 1;
        }
        
        .category-exercise-stats {
            font-size: 0.8em;
            color: #7f8c8d;
            background: #f8f9fa;
            padding: 2px 8px;
            border-radius: 10px;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è - –í–¢–û–†–û–ô –ë–õ–û–ö */
        .tabs {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
            background: white;
            padding: 8px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .tab {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            border: none;
            background: #f8f9fa;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            color: #7f8c8d;
            transition: all 0.3s;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }
        
        /* –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ - –¢–†–ï–¢–ò–ô –ë–õ–û–ö (–ø–æ–¥ –∫–Ω–æ–ø–∫–∞–º–∏) */
        .tab-content {
            display: none;
            margin-bottom: 15px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* –ö–∞–ª–µ–Ω–¥–∞—Ä—å - –ß–ï–¢–í–ï–†–¢–´–ô –ë–õ–û–ö (–ø–æ–¥ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –≤–∫–ª–∞–¥–æ–∫) */
        .calendar-section {
            margin-bottom: 15px;
        }
        
        .calendar-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .calendar-title {
            font-weight: 600;
            font-size: 1em;
        }
        
        .calendar-arrow {
            background: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            color: #27ae60;
        }
        
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 3px;
            background: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .calendar-header {
            text-align: center;
            font-size: 0.8em;
            color: #7f8c8d;
            padding: 5px 0;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .calendar-day.has-workout {
            background: #27ae60;
            color: white;
            font-weight: bold;
        }
        
        .calendar-day.selected {
            background: #2ecc71;
            color: white;
            box-shadow: 0 0 0 2px rgba(46, 204, 113, 0.3);
        }
        
        .calendar-day.empty {
            background: transparent;
            cursor: default;
        }
        
        /* –§–æ—Ä–º—ã */
        .form-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .form-card h2 {
            margin-bottom: 15px;
            color: #1a472a;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 12px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.95em;
            transition: border 0.3s;
            font-family: inherit;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: #27ae60;
            outline: none;
        }
        
        input[type="date"] {
            font-size: 0.95em;
            min-height: 44px;
        }
        
        .compact-input {
            font-size: 0.9em;
            padding: 10px;
        }
        
        .cardio-inputs, .standard-inputs {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }
        
        .hidden-field {
            display: none;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border: none;
            padding: 14px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary:active {
            transform: scale(0.98);
        }
        
        /* –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ */
        .workout-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 8px 0;
            position: relative;
            border-left: 4px solid #27ae60;
        }
        
        .workout-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .workout-date {
            font-weight: 600;
            color: #1a472a;
        }
        
        .workout-more-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            color: #7f8c8d;
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            transition: all 0.2s;
        }
        
        .workout-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 10px 0;
        }
        
        .stat {
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.8em;
            color: #7f8c8d;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-weight: 600;
            font-size: 1.1em;
            color: #1a472a;
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .stat-card-compact {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .stat-value-compact {
            font-size: 1.5em;
            font-weight: bold;
            color: #27ae60;
            margin-bottom: 5px;
        }
        
        .stat-label-compact {
            font-size: 0.85em;
            color: #7f8c8d;
        }
        
        .stat-date {
            font-size: 0.75em;
            color: #95a5a6;
            margin-top: 3px;
        }
        
        /* –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–Ω—è - –ü–û–î –ö–ê–õ–ï–ù–î–ê–†–ï–ú */
        .day-workouts {
            margin-top: 15px;
        }
        
        .date-header {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .date-title {
            font-size: 1em;
            font-weight: bold;
        }
        
        .date-workout-count {
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9em;
        }
        
        /* –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ - –ü–û–°–õ–ï–î–ù–ò–ô –ë–õ–û–ö */
        .backup-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .backup-section h3 {
            margin-bottom: 15px;
            color: #1a472a;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .backup-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .btn-backup {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            padding: 14px;
            border-radius: 8px;
            font-size: 0.95em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-backup:hover {
            background: #eafaf1;
            border-color: #27ae60;
        }
        
        .btn-backup.save {
            color: #27ae60;
        }
        
        .btn-backup.restore {
            color: #3498db;
        }
        
        .backup-info {
            margin-top: 10px;
            font-size: 0.85em;
            color: #7f8c8d;
            text-align: center;
        }
        
        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 2000;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .notification.success {
            border-left: 4px solid #27ae60;
        }
        
        .notification.error {
            border-left: 4px solid #e74c3c;
        }
        
        .notification.info {
            border-left: 4px solid #3498db;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 25px;
            width: 90%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn-secondary {
            background: #95a5a6;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            flex: 1;
        }
        
        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤—ã–±–æ—Ä–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è */
        .selected-exercise-indicator {
            background: #eafaf1;
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
            border-left: 4px solid #27ae60;
        }
        
        /* –ú–µ–Ω—é —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è */
        .more-btn {
            background: none;
            border: none;
            font-size: 1.2em;
            color: #7f8c8d;
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            transition: all 0.2s;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .more-btn:hover {
            background: rgba(0,0,0,0.05);
        }
        
        .dropdown-menu {
            position: absolute;
            top: 40px;
            right: 10px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            z-index: 100;
            min-width: 100px;
            display: none;
            overflow: hidden;
        }
        
        .dropdown-menu.show {
            display: block;
        }
        
        .dropdown-item {
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            border: none;
            width: 100%;
            background: none;
            font-size: 0.9em;
        }
        
        .dropdown-item:hover {
            background: #f8f9fa;
        }
        
        .dropdown-item.edit {
            color: #27ae60;
        }
        
        /* –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #7f8c8d;
        }
        
        .empty-state i {
            font-size: 3em;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .calendar {
                gap: 2px;
                padding: 8px;
            }
            
            .cardio-inputs, .standard-inputs {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .backup-buttons {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .tab {
                width: 40px;
                height: 40px;
                font-size: 1.1em;
            }
        }
    </style>
</head>
<body>
    <!-- 1. –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="header">
        <h1>üèãÔ∏è –î–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h1>
    </div>
    
    <!-- 2. –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π -->
    <div id="categories-container" class="categories-grid"></div>
    
    <!-- 3. –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="tabs">
        <button class="tab active" data-tab="home" title="–ì–ª–∞–≤–Ω–∞—è">
            <i class="fas fa-home"></i>
        </button>
        <button class="tab" data-tab="catalog" title="–ö–∞—Ç–∞–ª–æ–≥ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π">
            <i class="fas fa-dumbbell"></i>
        </button>
        <button class="tab" data-tab="workouts" title="–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏">
            <i class="fas fa-running"></i>
        </button>
        <button class="tab" data-tab="stats" title="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞">
            <i class="fas fa-chart-line"></i>
        </button>
    </div>
    
    <!-- 4. –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ (–ø–æ–¥ –∫–Ω–æ–ø–∫–∞–º–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏) -->
    
    <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
    <div class="tab-content active" id="home-tab">
        <div class="form-card">
            <h2><i class="fas fa-home"></i> –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –î–Ω–µ–≤–Ω–∏–∫ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h2>
            <p style="margin-bottom: 15px; color: #7f8c8d;">–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Å–≤–æ–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –¥–æ–±–∞–≤–ª—è—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å.</p>
            
            <div class="stats-grid">
                <div class="stat-card-compact">
                    <div class="stat-value-compact" id="welcome-total-exercises">0</div>
                    <div class="stat-label-compact">–í—Å–µ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</div>
                </div>
                <div class="stat-card-compact">
                    <div class="stat-value-compact" id="welcome-total-workouts">0</div>
                    <div class="stat-label-compact">–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
                </div>
                <div class="stat-card-compact">
                    <div class="stat-value-compact" id="welcome-this-week">0</div>
                    <div class="stat-label-compact">–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ</div>
                </div>
                <div class="stat-card-compact">
                    <div class="stat-value-compact" id="welcome-last-workout">-</div>
                    <div class="stat-label-compact">–ü–æ—Å–ª–µ–¥–Ω—è—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –í–∫–ª–∞–¥–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π -->
    <div class="tab-content" id="catalog-tab">
        <div class="form-card">
            <h2><i class="fas fa-plus-circle"></i> –ù–æ–≤–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</h2>
            <div class="form-group">
                <input type="text" id="exercise-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è">
            </div>
            <div class="form-group">
                <select id="exercise-category">
                    <option value="–ö–∞—Ä–¥–∏–æ">–ö–∞—Ä–¥–∏–æ</option>
                    <option value="–ù–æ–≥–∏ –∏ —è–≥–æ–¥–∏—Ü—ã">–ù–æ–≥–∏ –∏ —è–≥–æ–¥–∏—Ü—ã</option>
                    <option value="–†—É–∫–∏ –∏ —Å–ø–∏–Ω–∞">–†—É–∫–∏ –∏ —Å–ø–∏–Ω–∞</option>
                    <option value="–ì—Ä—É–¥—å –∏ –ø—Ä–µ—Å—Å">–ì—Ä—É–¥—å –∏ –ø—Ä–µ—Å—Å</option>
                    <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
                </select>
            </div>
            <div class="form-group">
                <textarea id="exercise-description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" rows="2"></textarea>
            </div>
            <button onclick="addExercise()" class="btn-primary">
                <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ
            </button>
        </div>
    </div>
    
    <!-- –í–∫–ª–∞–¥–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ -->
    <div class="tab-content" id="workouts-tab">
        <div class="form-card" id="workout-form-card">
            <h2><i class="fas fa-running"></i> –ù–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</h2>
            
            <div id="selected-exercise-indicator" class="selected-exercise-indicator" style="display: none;">
                <div style="font-weight: 600; color: #1a472a;" id="selected-exercise-name"></div>
                <div style="font-size: 0.9em; color: #7f8c8d;" id="selected-exercise-category"></div>
            </div>
            
            <div class="form-group">
                <select id="workout-exercise">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</option>
                </select>
            </div>
            <div class="form-group">
                <input type="date" id="workout-date" class="compact-input">
            </div>
            
            <div id="standard-fields" class="standard-inputs">
                <div class="form-group">
                    <input type="number" id="weight" placeholder="–í–µ—Å (–∫–≥)" step="0.5" min="0" class="compact-input">
                </div>
                <div class="form-group">
                    <input type="number" id="reps" placeholder="–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è" min="1" class="compact-input">
                </div>
                <div class="form-group">
                    <input type="number" id="sets" placeholder="–ü–æ–¥—Ö–æ–¥—ã" min="1" class="compact-input">
                </div>
            </div>
            
            <div id="cardio-fields" class="cardio-inputs hidden-field">
                <div class="form-group">
                    <input type="number" id="level" placeholder="–£—Ä–æ–≤–µ–Ω—å*" step="0.1" min="0" class="compact-input" required>
                </div>
                <div class="form-group">
                    <input type="number" id="distance" placeholder="–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ (–∫–º)" step="0.1" min="0" class="compact-input">
                </div>
                <div class="form-group">
                    <input type="number" id="time" placeholder="–í—Ä–µ–º—è (–º–∏–Ω)" step="1" min="0" class="compact-input">
                </div>
            </div>
            
            <div class="form-group">
                <input type="text" id="difficulty" placeholder="–°–ª–æ–∂–Ω–æ—Å—Ç—å (–ª–µ–≥–∫–æ/—Å—Ä–µ–¥–Ω–µ/—Ç—è–∂–µ–ª–æ)" class="compact-input">
            </div>
            
            <button onclick="addWorkout()" class="btn-primary">
                <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
            </button>
            <div style="font-size: 0.8em; color: #7f8c8d; margin-top: 10px; text-align: center;">
                * - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ –¥–ª—è –∫–∞—Ä–¥–∏–æ
            </div>
        </div>
        
        <div class="form-card">
            <h2><i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h2>
            <div id="exercise-history-container">
                <p style="text-align: center; color: #7f8c8d;">–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏</p>
            </div>
        </div>
    </div>
    
    <!-- –í–∫–ª–∞–¥–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div class="tab-content" id="stats-tab">
        <div class="form-card">
            <h2><i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            
            <div class="stats-grid">
                <div class="stat-card-compact">
                    <div class="stat-value-compact" id="total-exercises">0</div>
                    <div class="stat-label-compact">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</div>
                </div>
                <div class="stat-card-compact">
                    <div class="stat-value-compact" id="total-workouts">0</div>
                    <div class="stat-label-compact">–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</div>
                </div>
                <div class="stat-card-compact">
                    <div class="stat-value-compact" id="best-weight">0</div>
                    <div class="stat-label-compact">–õ—É—á—à–∏–π –≤–µ—Å (–∫–≥)</div>
                    <div class="stat-date" id="best-weight-date">-</div>
                </div>
                <div class="stat-card-compact">
                    <div class="stat-value-compact" id="last-workout">-</div>
                    <div class="stat-label-compact">–ü–æ—Å–ª–µ–¥–Ω—è—è</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 5. –ö–∞–ª–µ–Ω–¥–∞—Ä—å (–ø–æ–¥ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –≤–∫–ª–∞–¥–æ–∫) -->
    <div class="calendar-section">
        <div class="calendar-nav">
            <button class="calendar-arrow" id="prev-month">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div class="calendar-title" id="calendar-title"></div>
            <button class="calendar-arrow" id="next-month">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
        <div class="calendar" id="calendar"></div>
    </div>
    
    <!-- 6. –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –¥–Ω—è (–ø–æ–¥ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º) -->
    <div id="selected-day-workouts" class="day-workouts"></div>
    
    <!-- 7. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å–∞–º—ã–π –Ω–∏–∂–Ω–∏–π –±–ª–æ–∫) -->
    <div class="backup-section">
        <h3><i class="fas fa-database"></i> –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
        <div class="backup-buttons">
            <button onclick="createBackup()" class="btn-backup save">
                <i class="fas fa-save"></i> –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
            </button>
            <button onclick="restoreBackup()" class="btn-backup restore">
                <i class="fas fa-history"></i> –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
            </button>
        </div>
        <div class="backup-info" id="backup-info">
            –ü–æ—Å–ª–µ–¥–Ω–µ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ: –Ω–∏–∫–æ–≥–¥–∞
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è -->
    <div class="modal" id="exercise-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="margin: 0;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</h2>
                <button class="close-modal" id="close-modal">&times;</button>
            </div>
            <form id="edit-exercise-form">
                <input type="hidden" id="edit-exercise-id">
                <div class="form-group">
                    <input type="text" id="edit-exercise-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" required>
                </div>
                <div class="form-group">
                    <select id="edit-exercise-category" required>
                        <option value="–ö–∞—Ä–¥–∏–æ">–ö–∞—Ä–¥–∏–æ</option>
                        <option value="–ù–æ–≥–∏ –∏ —è–≥–æ–¥–∏—Ü—ã">–ù–æ–≥–∏ –∏ —è–≥–æ–¥–∏—Ü—ã</option>
                        <option value="–†—É–∫–∏ –∏ —Å–ø–∏–Ω–∞">–†—É–∫–∏ –∏ —Å–ø–∏–Ω–∞</option>
                        <option value="–ì—Ä—É–¥—å –∏ –ø—Ä–µ—Å—Å">–ì—Ä—É–¥—å –∏ –ø—Ä–µ—Å—Å</option>
                        <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
                    </select>
                </div>
                <div class="form-group">
                    <textarea id="edit-exercise-description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" rows="3"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeExerciseModal()">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let exercises = JSON.parse(localStorage.getItem('workoutDiaryExercises')) || [];
        let workouts = JSON.parse(localStorage.getItem('workoutDiaryWorkouts')) || [];
        let currentCalendarDate = new Date();
        let selectedCalendarDate = null;
        let expandedCategories = new Set();
        let currentSelectedExerciseId = null;
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
        const backupSettings = JSON.parse(localStorage.getItem('workoutDiaryBackup')) || {
            lastBackup: null,
            reminderShown: false
        };

        // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π —Å –∏–∫–æ–Ω–∫–∞–º–∏
        const categories = [
            { id: '–ö–∞—Ä–¥–∏–æ', name: '–ö–∞—Ä–¥–∏–æ', icon: 'fa-heart-pulse' },
            { id: '–ù–æ–≥–∏ –∏ —è–≥–æ–¥–∏—Ü—ã', name: '–ù–æ–≥–∏ –∏ —è–≥–æ–¥–∏—Ü—ã', icon: 'fa-person-running' },
            { id: '–†—É–∫–∏ –∏ —Å–ø–∏–Ω–∞', name: '–†—É–∫–∏ –∏ —Å–ø–∏–Ω–∞', icon: 'fa-dumbbell' },
            { id: '–ì—Ä—É–¥—å –∏ –ø—Ä–µ—Å—Å', name: '–ì—Ä—É–¥—å –∏ –ø—Ä–µ—Å—Å', icon: 'fa-user' },
            { id: '–î—Ä—É–≥–æ–µ', name: '–î—Ä—É–≥–æ–µ', icon: 'fa-ellipsis' }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é –¥–∞—Ç—É
            const today = new Date();
            const todayString = formatDateForInput(today);
            document.getElementById('workout-date').value = todayString;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            loadCategories();
            updateExerciseDropdown();
            updateStats();
            updateWelcomeStats();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
            initCalendar();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏
            checkBackupReminder();
            
            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            setupEventListeners();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
            updateBackupInfo();
        });

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã –¥–ª—è input type="date"
        function formatDateForInput(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
        function formatDateForComparison(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                    if (tabId === 'home') {
                        updateWelcomeStats();
                    }
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
                    if (tabId === 'workouts') {
                        loadExerciseHistory();
                    }
                });
            });
            
            // –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
            document.getElementById('edit-exercise-form').addEventListener('submit', function(e) {
                e.preventDefault();
                saveExerciseChanges();
            });
            
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
            document.getElementById('prev-month').addEventListener('click', () => {
                currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1);
                renderCalendar();
            });
            
            document.getElementById('next-month').addEventListener('click', () => {
                currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1);
                renderCalendar();
            });
            
            // –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ —Ñ–æ—Ä–º–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
            document.getElementById('workout-exercise').addEventListener('change', function() {
                const exerciseId = parseInt(this.value);
                if (exerciseId) {
                    currentSelectedExerciseId = exerciseId;
                    updateWorkoutFormFields();
                    loadExerciseHistory();
                } else {
                    currentSelectedExerciseId = null;
                    hideExerciseIndicator();
                }
            });
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            document.getElementById('close-modal').addEventListener('click', closeExerciseModal);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        function loadCategories() {
            const container = document.getElementById('categories-container');
            container.innerHTML = '';
            
            categories.forEach(category => {
                const categoryExercises = exercises.filter(exercise => exercise.category === category.id);
                
                const categoryCard = document.createElement('div');
                categoryCard.className = 'category-card';
                if (expandedCategories.has(category.id)) {
                    categoryCard.classList.add('expanded');
                }
                
                categoryCard.innerHTML = `
                    <div class="category-icon">
                        <i class="fas ${category.icon}"></i>
                    </div>
                    <div class="category-name">${category.name}</div>
                    <div class="category-count">${categoryExercises.length}</div>
                    <div class="category-arrow">
                        <i class="fas fa-chevron-down"></i>
                    </div>
                `;
                
                categoryCard.addEventListener('click', () => {
                    toggleCategory(category.id);
                });
                
                container.appendChild(categoryCard);
                
                // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                const exercisesContainer = document.createElement('div');
                exercisesContainer.id = `exercises-${category.id}`;
                exercisesContainer.className = 'category-exercises';
                if (expandedCategories.has(category.id)) {
                    exercisesContainer.classList.add('show');
                    showCategoryExercises(category.id, exercisesContainer);
                }
                container.appendChild(exercisesContainer);
            });
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function toggleCategory(categoryId) {
            if (expandedCategories.has(categoryId)) {
                expandedCategories.delete(categoryId);
            } else {
                expandedCategories.clear();
                expandedCategories.add(categoryId);
            }
            
            loadCategories();
        }

        // –ü–æ–∫–∞–∑ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function showCategoryExercises(categoryId, container) {
            const categoryExercises = exercises.filter(exercise => exercise.category === categoryId);
            
            if (categoryExercises.length === 0) {
                container.innerHTML = '<div style="padding: 10px; color: #95a5a6; font-style: italic; text-align: center;">–ù–µ—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</div>';
                return;
            }
            
            container.innerHTML = '';
            
            categoryExercises.forEach(exercise => {
                const exerciseElement = document.createElement('div');
                exerciseElement.className = 'category-exercise-item';
                
                const latestWorkout = workouts
                    .filter(w => w.exerciseId === exercise.id)
                    .sort((a, b) => new Date(b.date) - new Date(a.date))[0];
                
                let statsText = '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö';
                if (latestWorkout) {
                    if (exercise.category === '–ö–∞—Ä–¥–∏–æ') {
                        statsText = `–£—Ä–æ–≤–µ–Ω—å: ${latestWorkout.level || '0'}`;
                        if (latestWorkout.distance) {
                            statsText += `, ${latestWorkout.distance} –∫–º`;
                        }
                        if (latestWorkout.time) {
                            statsText += `, ${latestWorkout.time} –º–∏–Ω`;
                        }
                    } else {
                        statsText = `${latestWorkout.weight || '0'} –∫–≥ √ó ${latestWorkout.reps || '0'} / ${latestWorkout.sets || '0'}`;
                    }
                }
                
                exerciseElement.innerHTML = `
                    <div class="category-exercise-name">${exercise.name}</div>
                    <div class="category-exercise-stats">${statsText}</div>
                `;
                
                const moreBtn = document.createElement('button');
                moreBtn.className = 'more-btn';
                moreBtn.innerHTML = '‚ãØ';
                moreBtn.style.marginLeft = '8px';
                moreBtn.onclick = (e) => {
                    e.stopPropagation();
                    showExerciseMenuInCategory(e, exercise.id);
                };
                
                exerciseElement.appendChild(moreBtn);
                
                const dropdown = document.createElement('div');
                dropdown.className = 'dropdown-menu';
                dropdown.id = `category-dropdown-${exercise.id}`;
                dropdown.innerHTML = `
                    <button class="dropdown-item edit" onclick="openExerciseModal(${exercise.id})">
                        <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                `;
                
                exerciseElement.appendChild(dropdown);
                
                exerciseElement.addEventListener('click', (e) => {
                    if (!e.target.closest('.more-btn')) {
                        openNewWorkoutWithExercise(exercise.id);
                    }
                });
                
                container.appendChild(exerciseElement);
            });
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function showExerciseMenuInCategory(event, exerciseId) {
            event.stopPropagation();
            const dropdown = document.getElementById(`category-dropdown-${exerciseId}`);
            
            document.querySelectorAll('.dropdown-menu.show').forEach(menu => {
                if (menu !== dropdown) menu.classList.remove('show');
            });
            
            dropdown.classList.toggle('show');
        }

        // –û—Ç–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É –Ω–æ–≤–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ–º
        function openNewWorkoutWithExercise(exerciseId) {
            const exercise = exercises.find(e => e.id === exerciseId);
            if (!exercise) return;
            
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
            
            document.querySelector('.tab[data-tab="workouts"]').classList.add('active');
            document.getElementById('workouts-tab').classList.add('active');
            
            document.getElementById('workout-exercise').value = exerciseId;
            currentSelectedExerciseId = exerciseId;
            updateWorkoutFormFields();
            loadExerciseHistory();
            
            setTimeout(() => {
                document.getElementById('workout-form-card').scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        function showExerciseIndicator(name, category) {
            document.getElementById('selected-exercise-name').textContent = name;
            document.getElementById('selected-exercise-category').textContent = category;
            document.getElementById('selected-exercise-indicator').style.display = 'block';
        }

        // –°–∫—Ä—ã—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        function hideExerciseIndicator() {
            document.getElementById('selected-exercise-indicator').style.display = 'none';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        function updateWorkoutFormFields() {
            const exerciseId = currentSelectedExerciseId || parseInt(document.getElementById('workout-exercise').value);
            const exercise = exercises.find(e => e.id === exerciseId);
            
            if (exercise) {
                showExerciseIndicator(exercise.name, exercise.category);
                
                if (exercise.category === '–ö–∞—Ä–¥–∏–æ') {
                    document.getElementById('standard-fields').classList.add('hidden-field');
                    document.getElementById('cardio-fields').classList.remove('hidden-field');
                } else {
                    document.getElementById('standard-fields').classList.remove('hidden-field');
                    document.getElementById('cardio-fields').classList.add('hidden-field');
                }
            } else {
                hideExerciseIndicator();
            }
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        function addExercise() {
            const name = document.getElementById('exercise-name').value.trim();
            const category = document.getElementById('exercise-category').value;
            const description = document.getElementById('exercise-description').value.trim();
            
            if (!name) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è', 'error');
                return;
            }
            
            const exercise = {
                id: Date.now(),
                name: name,
                category: category,
                description: description,
                createdAt: new Date().toISOString()
            };
            
            exercises.push(exercise);
            localStorage.setItem('workoutDiaryExercises', JSON.stringify(exercises));
            
            loadCategories();
            updateExerciseDropdown();
            updateStats();
            updateWelcomeStats();
            
            document.getElementById('exercise-name').value = '';
            document.getElementById('exercise-description').value = '';
            
            expandedCategories.clear();
            expandedCategories.add(category);
            loadCategories();
            
            showNotification('–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ', 'success');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ dropdown —Å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏
        function updateExerciseDropdown() {
            const select = document.getElementById('workout-exercise');
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</option>';
            exercises.forEach(ex => {
                select.innerHTML += `<option value="${ex.id}">${ex.name}</option>`;
            });
            
            if (currentSelectedExerciseId) {
                select.value = currentSelectedExerciseId;
            }
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        function addWorkout() {
            const exerciseId = currentSelectedExerciseId || parseInt(document.getElementById('workout-exercise').value);
            const date = document.getElementById('workout-date').value;
            const difficulty = document.getElementById('difficulty').value.trim();
            
            if (!exerciseId || !date) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –∏ –¥–∞—Ç—É', 'error');
                return;
            }
            
            const exercise = exercises.find(e => e.id === exerciseId);
            if (!exercise) {
                showNotification('–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ', 'error');
                return;
            }
            
            let workoutData = {
                id: Date.now(),
                exerciseId: exerciseId,
                exerciseName: exercise.name,
                exerciseCategory: exercise.category,
                date: date,
                difficulty: difficulty || '—Å—Ä–µ–¥–Ω–µ'
            };
            
            if (exercise.category === '–ö–∞—Ä–¥–∏–æ') {
                const level = parseFloat(document.getElementById('level').value);
                const distance = document.getElementById('distance').value.trim();
                const time = document.getElementById('time').value.trim();
                
                if (isNaN(level) || level <= 0) {
                    showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª–µ –£—Ä–æ–≤–µ–Ω—å', 'error');
                    return;
                }
                
                workoutData.level = level;
                workoutData.distance = distance ? parseFloat(distance) : null;
                workoutData.time = time ? parseInt(time) : null;
                workoutData.weight = 0;
                workoutData.reps = 0;
                workoutData.sets = 0;
            } else {
                const weight = parseFloat(document.getElementById('weight').value);
                const reps = parseInt(document.getElementById('reps').value);
                const sets = parseInt(document.getElementById('sets').value);
                
                if (isNaN(weight) || weight <= 0 || isNaN(reps) || reps <= 0 || isNaN(sets) || sets <= 0) {
                    showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è –í–µ—Å, –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –∏ –ü–æ–¥—Ö–æ–¥—ã', 'error');
                    return;
                }
                
                workoutData.weight = weight;
                workoutData.reps = reps;
                workoutData.sets = sets;
                workoutData.level = 0;
                workoutData.distance = null;
                workoutData.time = null;
            }
            
            workouts.push(workoutData);
            localStorage.setItem('workoutDiaryWorkouts', JSON.stringify(workouts));
            
            loadCategories();
            updateStats();
            updateWelcomeStats();
            renderCalendar();
            loadExerciseHistory();
            
            document.getElementById('weight').value = '';
            document.getElementById('reps').value = '';
            document.getElementById('sets').value = '';
            document.getElementById('level').value = '';
            document.getElementById('distance').value = '';
            document.getElementById('time').value = '';
            document.getElementById('difficulty').value = '';
            
            document.getElementById('selected-day-workouts').innerHTML = '';
            
            showNotification('–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞', 'success');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        function loadExerciseHistory() {
            const container = document.getElementById('exercise-history-container');
            
            const exerciseId = currentSelectedExerciseId || parseInt(document.getElementById('workout-exercise').value);
            
            if (!exerciseId) {
                container.innerHTML = '<p style="text-align: center; color: #7f8c8d;">–í—ã–±–µ—Ä–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏</p>';
                return;
            }
            
            const exercise = exercises.find(e => e.id === exerciseId);
            if (!exercise) {
                container.innerHTML = '<p style="text-align: center; color: #7f8c8d;">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>';
                return;
            }
            
            const exerciseWorkouts = workouts
                .filter(w => w.exerciseId === exerciseId)
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 10);
            
            if (exerciseWorkouts.length === 0) {
                container.innerHTML = `
                    <p style="text-align: center; color: #7f8c8d;">
                        –ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ö –¥–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è<br>
                        <strong>${exercise.name}</strong>
                    </p>
                `;
                return;
            }
            
            let html = `<div style="margin-bottom: 15px; font-weight: 600; color: #1a472a;">${exercise.name} - –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:</div>`;
            
            exerciseWorkouts.forEach(workout => {
                const date = new Date(workout.date).toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric'
                });
                
                html += `
                    <div class="workout-history-item">
                        <div class="workout-header">
                            <div class="workout-date">${date}</div>
                            <button class="workout-more-btn" onclick="deleteWorkout(${workout.id})">‚ãØ</button>
                        </div>
                        
                        <div class="workout-stats">
                            ${exercise.category === '–ö–∞—Ä–¥–∏–æ' ? `
                                <div class="stat">
                                    <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å</div>
                                    <div class="stat-value">${workout.level || '0'}</div>
                                </div>
                                ${workout.distance ? `
                                <div class="stat">
                                    <div class="stat-label">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ</div>
                                    <div class="stat-value">${workout.distance} –∫–º</div>
                                </div>
                                ` : ''}
                                ${workout.time ? `
                                <div class="stat">
                                    <div class="stat-label">–í—Ä–µ–º—è</div>
                                    <div class="stat-value">${workout.time} –º–∏–Ω</div>
                                </div>
                                ` : ''}
                                ${!workout.distance && !workout.time ? `
                                <div class="stat">
                                    <div class="stat-label">–¢–∏–ø</div>
                                    <div class="stat-value">–ö–∞—Ä–¥–∏–æ</div>
                                </div>
                                ` : ''}
                            ` : `
                                <div class="stat">
                                    <div class="stat-label">–í–µ—Å</div>
                                    <div class="stat-value">${workout.weight} –∫–≥</div>
                                </div>
                                <div class="stat">
                                    <div class="stat-label">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</div>
                                    <div class="stat-value">${workout.reps}</div>
                                </div>
                                <div class="stat">
                                    <div class="stat-label">–ü–æ–¥—Ö–æ–¥—ã</div>
                                    <div class="stat-value">${workout.sets}</div>
                                </div>
                            `}
                        </div>
                        
                        ${workout.difficulty ? `<div style="margin-top: 10px; color: #7f8c8d;">–°–ª–æ–∂–Ω–æ—Å—Ç—å: ${workout.difficulty}</div>` : ''}
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        function deleteWorkout(id) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É?')) {
                return;
            }
            
            workouts = workouts.filter(w => w.id !== id);
            localStorage.setItem('workoutDiaryWorkouts', JSON.stringify(workouts));
            
            loadCategories();
            updateStats();
            updateWelcomeStats();
            renderCalendar();
            loadExerciseHistory();
            
            document.getElementById('selected-day-workouts').innerHTML = '';
            
            showNotification('–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —É–¥–∞–ª–µ–Ω–∞', 'success');
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        function openExerciseModal(id) {
            const exercise = exercises.find(e => e.id === id);
            
            if (exercise) {
                document.getElementById('edit-exercise-id').value = exercise.id;
                document.getElementById('edit-exercise-name').value = exercise.name;
                document.getElementById('edit-exercise-category').value = exercise.category;
                document.getElementById('edit-exercise-description').value = exercise.description || '';
                
                document.getElementById('exercise-modal').classList.add('active');
                
                document.querySelectorAll('.dropdown-menu.show').forEach(menu => menu.classList.remove('show'));
            }
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        function closeExerciseModal() {
            document.getElementById('exercise-modal').classList.remove('active');
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
        function saveExerciseChanges() {
            const id = parseInt(document.getElementById('edit-exercise-id').value);
            const name = document.getElementById('edit-exercise-name').value.trim();
            const category = document.getElementById('edit-exercise-category').value;
            const description = document.getElementById('edit-exercise-description').value.trim();
            
            if (!name || !category) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é', 'error');
                return;
            }
            
            const index = exercises.findIndex(e => e.id === id);
            if (index !== -1) {
                exercises[index] = {
                    ...exercises[index],
                    name,
                    category,
                    description
                };
                
                workouts.forEach(workout => {
                    if (workout.exerciseId === id) {
                        workout.exerciseCategory = category;
                    }
                });
                
                localStorage.setItem('workoutDiaryExercises', JSON.stringify(exercises));
                localStorage.setItem('workoutDiaryWorkouts', JSON.stringify(workouts));
                
                loadCategories();
                updateExerciseDropdown();
                updateStats();
                updateWelcomeStats();
                loadExerciseHistory();
                
                closeExerciseModal();
                showNotification('–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ', 'success');
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        function initCalendar() {
            renderCalendar();
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        function renderCalendar() {
            const calendar = document.getElementById('calendar');
            const title = document.getElementById('calendar-title');
            
            const monthNames = [
                '–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
                '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'
            ];
            
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            
            title.textContent = `${monthNames[month]} ${year}`;
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            
            let firstDayOfWeek = firstDay.getDay();
            if (firstDayOfWeek === 0) firstDayOfWeek = 6;
            else firstDayOfWeek--;
            
            const workoutDates = new Set();
            workouts.forEach(workout => {
                const date = new Date(workout.date);
                const dateString = formatDateForComparison(date);
                workoutDates.add(dateString);
            });
            
            calendar.innerHTML = '';
            
            const dayNames = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
            dayNames.forEach(dayName => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-header';
                dayHeader.textContent = dayName;
                calendar.appendChild(dayHeader);
            });
            
            for (let i = 0; i < firstDayOfWeek; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day empty';
                calendar.appendChild(emptyDay);
            }
            
            const daysInMonth = lastDay.getDate();
            for (let day = 1; day <= daysInMonth; day++) {
                const dayDate = new Date(year, month, day);
                const dateString = formatDateForComparison(dayDate);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;
                dayElement.dataset.date = dateString;
                
                const hasWorkout = workoutDates.has(dateString);
                if (hasWorkout) {
                    dayElement.classList.add('has-workout');
                }
                
                if (selectedCalendarDate === dateString) {
                    dayElement.classList.add('selected');
                }
                
                dayElement.addEventListener('click', () => {
                    document.querySelectorAll('.calendar-day.selected').forEach(d => {
                        d.classList.remove('selected');
                    });
                    
                    dayElement.classList.add('selected');
                    selectedCalendarDate = dateString;
                    
                    if (hasWorkout) {
                        showDayWorkouts(dateString);
                    } else {
                        openNewWorkoutWithDate(dateString);
                    }
                });
                
                calendar.appendChild(dayElement);
            }
        }

        // –û—Ç–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É –Ω–æ–≤–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –¥–∞—Ç–æ–π
        function openNewWorkoutWithDate(dateString) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
            
            document.querySelector('.tab[data-tab="workouts"]').classList.add('active');
            document.getElementById('workouts-tab').classList.add('active');
            
            document.getElementById('workout-date').value = dateString;
            
            document.getElementById('selected-day-workouts').innerHTML = '';
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–µ–Ω—å
        function showDayWorkouts(date) {
            const container = document.getElementById('selected-day-workouts');
            
            const dayWorkouts = workouts.filter(w => {
                const workoutDate = new Date(w.date);
                const workoutDateString = formatDateForComparison(workoutDate);
                return workoutDateString === date;
            });
            
            if (dayWorkouts.length === 0) {
                container.innerHTML = '';
                return;
            }
            
            const dateObj = new Date(date);
            const formattedDate = dateObj.toLocaleDateString('ru-RU', {
                day: 'numeric',
                month: 'long',
                year: 'numeric',
                weekday: 'long'
            });
            
            let html = `
                <div class="date-header">
                    <div class="date-title">${formattedDate}</div>
                    <div class="date-workout-count">${dayWorkouts.length} —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π</div>
                </div>
            `;
            
            dayWorkouts.forEach(workout => {
                const exercise = exercises.find(e => e.id === workout.exerciseId);
                if (!exercise) return;
                
                html += `
                    <div class="workout-item">
                        <div class="workout-header">
                            <div class="workout-date">${workout.exerciseName}</div>
                        </div>
                        
                        <div class="workout-stats">
                            ${exercise.category === '–ö–∞—Ä–¥–∏–æ' ? `
                                <div class="stat">
                                    <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å</div>
                                    <div class="stat-value">${workout.level || '0'}</div>
                                </div>
                                ${workout.distance ? `
                                <div class="stat">
                                    <div class="stat-label">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ</div>
                                    <div class="stat-value">${workout.distance} –∫–º</div>
                                </div>
                                ` : ''}
                                ${workout.time ? `
                                <div class="stat">
                                    <div class="stat-label">–í—Ä–µ–º—è</div>
                                    <div class="stat-value">${workout.time} –º–∏–Ω</div>
                                </div>
                                ` : ''}
                            ` : `
                                <div class="stat">
                                    <div class="stat-label">–í–µ—Å</div>
                                    <div class="stat-value">${workout.weight} –∫–≥</div>
                                </div>
                                <div class="stat">
                                    <div class="stat-label">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</div>
                                    <div class="stat-value">${workout.reps}</div>
                                </div>
                                <div class="stat">
                                    <div class="stat-label">–ü–æ–¥—Ö–æ–¥—ã</div>
                                    <div class="stat-value">${workout.sets}</div>
                                </div>
                            `}
                        </div>
                        
                        ${workout.difficulty ? `<div style="margin-top: 10px; color: #7f8c8d;">–°–ª–æ–∂–Ω–æ—Å—Ç—å: ${workout.difficulty}</div>` : ''}
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            document.getElementById('total-exercises').textContent = exercises.length;
            
            const uniqueDates = new Set();
            workouts.forEach(workout => {
                const date = new Date(workout.date);
                const dateString = formatDateForComparison(date);
                uniqueDates.add(dateString);
            });
            document.getElementById('total-workouts').textContent = uniqueDates.size;
            
            const weightWorkouts = workouts.filter(w => w.exerciseCategory !== '–ö–∞—Ä–¥–∏–æ' && w.weight > 0);
            if (weightWorkouts.length > 0) {
                const bestWorkout = weightWorkouts.reduce((best, current) => 
                    current.weight > best.weight ? current : best
                );
                document.getElementById('best-weight').textContent = bestWorkout.weight;
                
                const date = new Date(bestWorkout.date).toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric'
                });
                document.getElementById('best-weight-date').textContent = date;
            } else {
                document.getElementById('best-weight').textContent = '0';
                document.getElementById('best-weight-date').textContent = '-';
            }
            
            if (workouts.length > 0) {
                const lastWorkout = workouts.sort((a, b) => new Date(b.date) - new Date(a.date))[0];
                const date = new Date(lastWorkout.date).toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'short'
                });
                document.getElementById('last-workout').textContent = date;
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function updateWelcomeStats() {
            document.getElementById('welcome-total-exercises').textContent = exercises.length;
            
            const uniqueDates = new Set();
            workouts.forEach(workout => {
                const date = new Date(workout.date);
                const dateString = formatDateForComparison(date);
                uniqueDates.add(dateString);
            });
            document.getElementById('welcome-total-workouts').textContent = uniqueDates.size;
            
            // –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ
            const now = new Date();
            const startOfWeek = new Date(now);
            startOfWeek.setDate(now.getDate() - now.getDay() + 1); // –ù–∞—á–∞–ª–æ –Ω–µ–¥–µ–ª–∏ (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫)
            startOfWeek.setHours(0, 0, 0, 0);
            
            const thisWeekWorkouts = workouts.filter(workout => {
                const workoutDate = new Date(workout.date);
                return workoutDate >= startOfWeek;
            });
            
            const uniqueThisWeekDates = new Set();
            thisWeekWorkouts.forEach(workout => {
                const date = new Date(workout.date);
                const dateString = formatDateForComparison(date);
                uniqueThisWeekDates.add(dateString);
            });
            
            document.getElementById('welcome-this-week').textContent = uniqueThisWeekDates.size;
            
            // –ü–æ—Å–ª–µ–¥–Ω—è—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞
            if (workouts.length > 0) {
                const lastWorkout = workouts.sort((a, b) => new Date(b.date) - new Date(a.date))[0];
                const date = new Date(lastWorkout.date).toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'short'
                });
                document.getElementById('welcome-last-workout').textContent = date;
            } else {
                document.getElementById('welcome-last-workout').textContent = '-';
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
        function createBackup() {
            try {
                const backupData = {
                    exercises: exercises,
                    workouts: workouts,
                    backupDate: new Date().toISOString(),
                    version: '1.0'
                };
                
                localStorage.setItem('workoutDiaryBackupData', JSON.stringify(backupData));
                
                backupSettings.lastBackup = new Date().toISOString();
                backupSettings.reminderShown = true;
                localStorage.setItem('workoutDiaryBackup', JSON.stringify(backupSettings));
                
                updateBackupInfo();
                
                showNotification('–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ', 'success');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏:', error);
                showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏', 'error');
            }
        }

        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
        function restoreBackup() {
            try {
                const backupData = localStorage.getItem('workoutDiaryBackupData');
                
                if (!backupData) {
                    showNotification('–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                    return;
                }
                
                if (!confirm('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏? –¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–º–µ–Ω–µ–Ω—ã.')) {
                    return;
                }
                
                const data = JSON.parse(backupData);
                
                exercises = data.exercises || [];
                workouts = data.workouts || [];
                
                localStorage.setItem('workoutDiaryExercises', JSON.stringify(exercises));
                localStorage.setItem('workoutDiaryWorkouts', JSON.stringify(workouts));
                
                loadCategories();
                updateExerciseDropdown();
                updateStats();
                updateWelcomeStats();
                renderCalendar();
                loadExerciseHistory();
                
                showNotification('–î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ', 'success');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö', 'error');
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
        function updateBackupInfo() {
            const backupInfo = document.getElementById('backup-info');
            
            if (backupSettings.lastBackup) {
                const lastBackupDate = new Date(backupSettings.lastBackup);
                const formattedDate = lastBackupDate.toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                backupInfo.textContent = `–ü–æ—Å–ª–µ–¥–Ω–µ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ: ${formattedDate}`;
            } else {
                backupInfo.textContent = '–ü–æ—Å–ª–µ–¥–Ω–µ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ: –Ω–∏–∫–æ–≥–¥–∞';
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–º –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏
        function checkBackupReminder() {
            if (backupSettings.lastBackup) {
                const lastBackupDate = new Date(backupSettings.lastBackup);
                const oneWeekAgo = new Date();
                oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
                
                if (lastBackupDate < oneWeekAgo && !backupSettings.reminderShown) {
                    setTimeout(() => {
                        if (confirm('–ü—Ä–æ—à–ª–∞ –Ω–µ–¥–µ–ª—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è. –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Å–µ–π—á–∞—Å?')) {
                            createBackup();
                        } else {
                            backupSettings.reminderShown = true;
                            localStorage.setItem('workoutDiaryBackup', JSON.stringify(backupSettings));
                        }
                    }, 2000);
                }
            } else if (!backupSettings.reminderShown) {
                setTimeout(() => {
                    if (confirm('–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –¥–∞–Ω–Ω—ã—Ö. –°–æ–∑–¥–∞—Ç—å —Å–µ–π—á–∞—Å?')) {
                        createBackup();
                    } else {
                        backupSettings.reminderShown = true;
                        localStorage.setItem('workoutDiaryBackup', JSON.stringify(backupSettings));
                    }
                }, 2000);
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message, type = 'success') {
            document.querySelectorAll('.notification').forEach(n => n.remove());
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                <span>${message}</span>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –ø—É—Å—Ç–æ)
        if (exercises.length === 0) {
            exercises = [
                { id: 1, name: '–ë–µ–≥ –Ω–∞ –¥–æ—Ä–æ–∂–∫–µ', category: '–ö–∞—Ä–¥–∏–æ', description: '–ë–µ–≥–æ–≤–∞—è –¥–æ—Ä–æ–∂–∫–∞', createdAt: new Date().toISOString() },
                { id: 2, name: '–ü—Ä–∏—Å–µ–¥–∞–Ω–∏—è —Å–æ —à—Ç–∞–Ω–≥–æ–π', category: '–ù–æ–≥–∏ –∏ —è–≥–æ–¥–∏—Ü—ã', description: '–ë–∞–∑–æ–≤–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ', createdAt: new Date().toISOString() },
                { id: 3, name: '–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ª–µ–∂–∞', category: '–ì—Ä—É–¥—å –∏ –ø—Ä–µ—Å—Å', description: '–ñ–∏–º –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π —Å–∫–∞–º—å–µ', createdAt: new Date().toISOString() },
                { id: 4, name: '–¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞', category: '–†—É–∫–∏ –∏ —Å–ø–∏–Ω–∞', description: '–¢—è–≥–∞ –∫ –≥—Ä—É–¥–∏', createdAt: new Date().toISOString() }
            ];
            localStorage.setItem('workoutDiaryExercises', JSON.stringify(exercises));
            
            loadCategories();
            updateExerciseDropdown();
            updateWelcomeStats();
        }
    </script>
</body>
</html>
